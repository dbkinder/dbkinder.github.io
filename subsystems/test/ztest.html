

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js" lang="en" > <!--<![endif]-->
  <head>
    <meta charset="utf-8">
   <!-- Google Tag Manager -->
   <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
   new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
   })(window,document,'script','dataLayer','GTM-KMP8MS');</script>
   <!-- End Google Tag Manager -->
    <link rel="apple-touch-icon" sizes="57x57" href="../../_static/img/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="../../_static/img/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="../../_static/img/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="../../_static/img/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="../../_static/img/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="../../_static/img/apple-touch-icon-120x120.png">
    <link rel="icon" type="image/png" href="../../_static/img/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="../../_static/img/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="../../_static/img/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="../../_static/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Zephyr Project">
    <meta name="application-name" content="Zephyr Project">
    <meta name="msapplication-TileColor" content="#da532c">
    <meta name="theme-color" content="#ffffff">

    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    
    <title>Test Framework &mdash; Zephyr Project Documentation</title>
    

    
    

    

    
    
      
    

    
    
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    

    
      <link rel="stylesheet" href="../../_static/zephyr-custom.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/normalize.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/layout.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/main.css" type="text/css" />
    
      <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    

    
        <link rel="index" title="Index" href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
        <link rel="copyright" title="Copyright" href="../../copyright.html"/>
      <link rel="top" title="Zephyr Project Documentation" href="../../index.html"/>
        <link rel="up" title="Testing" href="index.html"/>
        <link rel="next" title="Zephyr Sanity Tests" href="sanitycheck.html"/>
        <link rel="prev" title="Testing" href="index.html"/> 

    
    <script src="../../_static/js/modernizr.min.js"></script>

  </head>

  <body class="not-front page-documentation one-sidebar sidebar-first" role="document" >
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KMP8MS"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <div id="page">
      <header id="header">
  <div class="header-wrapper">
    <div class="container">
      <a href="https://zephyrproject.org/" title="Zephyr Project" rel="home" id="logo">
        <img src="../../_static/img/logo_white.png" alt="Zephyr Project">
      </a>
      <a href="" id="navigation-toggle">
        <span> </span>
        Menu
      </a>
      <nav id="navigation" class="menu with-primary with-secondary">
        <ul class="header-menu main-menu">
          <li class="first expanded about mid-1209"><a href="https://zephyrproject.org/about/"><span>About</span></a>
            <ul class="menu">
              <li class="first leaf what-is-zephyr mid-2563"><a href="https://zephyrproject.org/what-is-zephyr/"><span>What is the Zephyr Project?</span></a></li>
              <li class="leaf organization mid-2564"><a href="https://zephyrproject.org/about/organization/"><span>Organization</span></a></li>
              <li class="leaf memberships mid-2532"><a href="https://zephyrproject.org/#members"><span>Members</span></a></li>
              <li class="leaf faq mid-2525"><a href="https://zephyrproject.org/about/#faq"><span>FAQ</span></a></li>
              <li class="leaf join mid-2622"><a href="https://zephyrproject.org/join/"><span>Join</span></a></li>
              <li class="last leaf contact-us mid-2530"><a href="https://zephyrproject.org/about/#contact-us"><span>Contact Us</span></a></li>
            </ul>
          </li>
          <li class="expanded developers mid-1209"><a href="https://zephyrproject.org/developers/"><span>Developers</span></a>
            <ul class="menu">
              <li class="first expanded leaf code mid-2563"><a href="https://github.com/zephyrproject-rtos/zephyr/" target="_blank"><span>Code</span></a></li>
              <li class="leaf downloads mid-2564"><a href="https://zephyrproject.org/developers/#downloads"><span>Downloads</span></a></li>
              <li class="leaf documentation mid-2564"><a href="http://docs.zephyrproject.org/index.html" target="_blank"><span>Documentation</span></a></li>
              <li class="leaf supported-boards mid-2564"><a href="http://docs.zephyrproject.org/boards/boards.html" target="_blank"><span>Supported Boards</span></a></li>
              <li class="leaf releases-overview mid-2564"><a href="https://zephyrproject.org/developers/#releases-overview"><span>Releases Overview</span></a></li>
              <li class="leaf how-to-contribute mid-2564"><a href="https://zephyrproject.org/developers/how-to-contribute/"><span>How to Contribute</span></a></li>
              <li class="last leaf community-guidelines mid-2564"><a href="https://zephyrproject.org/developers/how-to-contribute/#community-guidelines"><span>Community Guidelines</span></a></li>
            </ul>
          </li>
          <li class="expanded news mid-1209"><a href="https://zephyrproject.org/news/"><span>News</span></a>
            <ul class="menu">
              <li class="first leaf announcements mid-2563"><a href="https://zephyrproject.org/news/announcements/"><span>Announcements</span></a></li>
              <li class="leaf blog mid-2563"><a href="https://zephyrproject.org/news/blog/"><span>Blog</span></a></li>
              <li class="last leaf events mid-2563"><a href="https://zephyrproject.org/events/"><span>Events</span></a></li>
            </ul>
          </li>
          <li class="last expanded project-resources mid-1209"><a href="https://zephyrproject.org/project-resources/"><span>Project Resources</span></a>
            <ul class="menu">
              <li class="first leaf presentations mid-2563"><a href="https://zephyrproject.org/project-resources/presentations/"><span>Presentations</span></a></li>
              <li class="leaf videos mid-2563"><a href="https://zephyrproject.org/project-resources/videos/"><span>Videos</span></a></li>
              <li class="leaf demos mid-2563"><a href="https://zephyrproject.org/project-resources/demos/"><span>Demos</span></a></li>
              <li class="leaf zephyr-in-market mid-2563"><a href="https://zephyrproject.org/project-resources/zephyr-in-market/"><span>Zephyr in Market</span></a></li>
              <li class="last leaf developer-tools mid-2563"><a href="https://zephyrproject.org/project-resources/developer-tools/"><span>Developer Tools</span></a></li>
            </ul>
          </li>
        </ul>
      </nav><!-- /navigation -->
    </div>
  </div>
</header><!-- /header -->
      <!-- STARTS #main -->
      <div id="main">
        <!-- STARTS .main-container -->
        <div class="main-container">
          

 



<!-- Docs -->





<div id="breadcrumb">
  <div class="container">
    <a href="/">Home</a> / 
    <a href="../../index.html">Docs</a> /
      
          <a href="../subsystems.html">Subsystems</a> /
      
          <a href="index.html">Testing</a> /
      
  </div>
</div>
          <aside id="sidebar-first" class="container-sidebar">
            
            <span id="secondary-menu-button" class="">Documentation</span>
<div class="region region-sidebar">
  <div class="docs-menu">
  
    
    
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/introducing_zephyr.html">Introducing Zephyr</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started/getting_started.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contribute/contribute.html">Contributing to the Zephyr Project</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel/kernel.html">Zephyr Kernel Primer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/security.html">Zephyr Project Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application/index.html">Developer Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../boards/boards.html">Supported Boards</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../devices/index.html">Device and Driver Support</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../subsystems.html">Subsystems</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../bluetooth/bluetooth.html">Bluetooth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../c_library.html">Standard C Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging/index.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/networking.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../power_management.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sensor.html">Sensor Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../shell.html">Shell</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Testing</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Test Framework</a></li>
<li class="toctree-l3"><a class="reference internal" href="sanitycheck.html">Zephyr Sanity Tests</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../usb/usb.html">USB device stack</a></li>
</ul>
</li>
</ul>

    
  
  </div>
<div role="search" class="sphinx-search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search documentation" class="search-documentation" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
</div>
          </aside>
          <!-- STARTS .content SECTION-->
          <section id="content" class="row">
            
	    
            <div class="rst-content">
              <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
                <div itemprop="articleBody">
                  
  <div class="section" id="test-framework">
<span id="testing"></span><h1>Test Framework<a class="headerlink" href="#test-framework" title="Permalink to this headline">¶</a></h1>
<p>The Zephyr Test Framework (Ztest) provides a simple testing framework intended
to be used during development.  It provides basic assertion macros and a generic
test structure.</p>
<p>The framework can be used in two ways, either as a generic framework for
integration testing, or for unit testing specific modules.</p>
<div class="section" id="quick-start-integration-testing">
<h2>Quick start - Integration testing<a class="headerlink" href="#quick-start-integration-testing" title="Permalink to this headline">¶</a></h2>
<p>A simple working base is located at <code class="file docutils literal"><span class="pre">samples/testing/integration</span></code>.  Just
copy the files to <code class="docutils literal"><span class="pre">tests/</span></code> and edit them for your needs. The test will then
be automatically built and run by the sanitycheck script. If you are testing
the <strong>bar</strong> component of <strong>foo</strong>, you should copy the sample folder to
<code class="docutils literal"><span class="pre">tests/foo/bar</span></code>. It can then be tested with:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">scripts</span><span class="o">/</span><span class="n">sanitycheck</span> <span class="o">-</span><span class="n">s</span> <span class="n">tests</span><span class="o">/</span><span class="n">foo</span><span class="o">/</span><span class="n">bar</span><span class="o">/</span><span class="n">test</span>
</pre></div>
</div>
<p>The sample contains the following files:</p>
<p>CMakeLists.txt</p>
<div class="highlight-CMake"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">include</span><span class="p">(</span><span class="o">$ENV{</span><span class="nv">ZEPHYR_BASE</span><span class="o">}</span><span class="s">/cmake/app/boilerplate.cmake</span> <span class="s">NO_POLICY_SCOPE</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">NONE</span><span class="p">)</span>

<span class="nb">FILE</span><span class="p">(</span><span class="s">GLOB</span> <span class="s">app_sources</span> <span class="s">src/*.c</span><span class="p">)</span>
<span class="nb">target_sources</span><span class="p">(</span><span class="s">app</span> <span class="s">PRIVATE</span> <span class="o">${</span><span class="nv">app_sources</span><span class="o">}</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>sample.yaml</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">sample</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">TBD</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">TBD</span>
<span class="l l-Scalar l-Scalar-Plain">tests</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">test</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">my_tags</span>
</pre></div>
</td></tr></table></div>
<p>prj.conf</p>
<div class="highlight-text"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="highlight"><pre><span></span>CONFIG_ZTEST=y
</pre></div>
</td></tr></table></div>
<p>src/main.c</p>
<div class="highlight-c"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2016 Intel Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * SPDX-License-Identifier: Apache-2.0</span>
<span class="cm"> */</span>

<span class="cp">#include</span> <span class="cpf">&lt;ztest.h&gt;</span><span class="cp"></span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">assert_tests</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">zassert_true</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;1 was false&quot;</span><span class="p">);</span>
	<span class="n">zassert_false</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="s">&quot;0 was true&quot;</span><span class="p">);</span>
	<span class="n">zassert_is_null</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;NULL was not NULL&quot;</span><span class="p">);</span>
	<span class="n">zassert_not_null</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">,</span> <span class="s">&quot;</span><span class="se">\&quot;</span><span class="s">foo</span><span class="se">\&quot;</span><span class="s"> was NULL&quot;</span><span class="p">);</span>
	<span class="n">zassert_equal</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;1 was not equal to 1&quot;</span><span class="p">);</span>
	<span class="n">zassert_equal_ptr</span><span class="p">(</span><span class="nb">NULL</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;NULL was not equal to NULL&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ztest_test_suite</span><span class="p">(</span><span class="n">framework_tests</span><span class="p">,</span>
		<span class="n">ztest_unit_test</span><span class="p">(</span><span class="n">assert_tests</span><span class="p">)</span>
	<span class="p">);</span>

	<span class="n">ztest_run_test_suite</span><span class="p">(</span><span class="n">framework_tests</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="quick-start-unit-testing">
<h2>Quick start - Unit testing<a class="headerlink" href="#quick-start-unit-testing" title="Permalink to this headline">¶</a></h2>
<p>Ztest can be used for unit testing. This means that rather than including the
entire Zephyr OS for testing a single function, you can focus the testing
efforts into the specific module in question. This will speed up testing since
only the module will have to be compiled in, and the tested functions will be
called directly.</p>
<p>Since you won’t be including basic kernel data structures that most code
depends on, you have to provide function stubs in the test. Ztest provides
some helpers for mocking functions, as demonstrated below.</p>
<p>In a unit test, mock objects can simulate the behavior of complex real objects
and are used to decide whether a test failed or passed by verifying whether an
interaction with an object occurred, and if required, to assert the order of
that interaction.</p>
<p>The <code class="file docutils literal"><span class="pre">samples/testing/unit</span></code> folder contains an example for testing
the net-buf api of Zephyr.</p>
<p>CMakeLists.txt</p>
<div class="highlight-CMake"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="s">APPEND</span> <span class="s">INCLUDE</span> <span class="s">subsys</span><span class="p">)</span>

<span class="nb">include</span><span class="p">(</span><span class="o">$ENV{</span><span class="nv">ZEPHYR_BASE</span><span class="o">}</span><span class="s">/tests/unit/unittest.cmake</span><span class="p">)</span>
<span class="nb">project</span><span class="p">(</span><span class="s">none</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>sample.yaml</p>
<div class="highlight-yaml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">sample</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">description</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">TBD</span>
  <span class="l l-Scalar l-Scalar-Plain">name</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">TBD</span>
<span class="l l-Scalar l-Scalar-Plain">tests</span><span class="p p-Indicator">:</span>
  <span class="l l-Scalar l-Scalar-Plain">test</span><span class="p p-Indicator">:</span>
    <span class="l l-Scalar l-Scalar-Plain">tags</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">buf</span>
    <span class="l l-Scalar l-Scalar-Plain">type</span><span class="p p-Indicator">:</span> <span class="l l-Scalar l-Scalar-Plain">unit</span>
</pre></div>
</td></tr></table></div>
<p>main.c</p>
<div class="highlight-c"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cm">/*</span>
<span class="cm"> * Copyright (c) 2016 Intel Corporation</span>
<span class="cm"> *</span>
<span class="cm"> * SPDX-License-Identifier: Apache-2.0</span>
<span class="cm"> */</span>

<span class="cp">#include</span> <span class="cpf">&lt;ztest.h&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;net/buf.h&gt;</span><span class="cp"></span>

<span class="k">struct</span> <span class="n">net_buf_pool</span> <span class="n">_net_buf_pool_list</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>

<span class="kt">unsigned</span> <span class="kt">int</span> <span class="nf">irq_lock</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">irq_unlock</span><span class="p">(</span><span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">key</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="cp">#include</span> <span class="cpf">&lt;net/buf.c&gt;</span><span class="cp"></span>

<span class="kt">void</span> <span class="nf">k_queue_init</span><span class="p">(</span><span class="k">struct</span> <span class="n">k_queue</span> <span class="o">*</span><span class="n">fifo</span><span class="p">)</span> <span class="p">{}</span>
<span class="kt">void</span> <span class="nf">k_queue_append_list</span><span class="p">(</span><span class="k">struct</span> <span class="n">k_queue</span> <span class="o">*</span><span class="n">fifo</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">head</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">tail</span><span class="p">)</span> <span class="p">{}</span>

<span class="kt">int</span> <span class="nf">k_is_in_isr</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="o">*</span><span class="nf">k_queue_get</span><span class="p">(</span><span class="k">struct</span> <span class="n">k_queue</span> <span class="o">*</span><span class="n">fifo</span><span class="p">,</span> <span class="n">s32_t</span> <span class="n">timeout</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="nb">NULL</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">k_queue_append</span><span class="p">(</span><span class="k">struct</span> <span class="n">k_queue</span> <span class="o">*</span><span class="n">fifo</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">k_queue_prepend</span><span class="p">(</span><span class="k">struct</span> <span class="n">k_queue</span> <span class="o">*</span><span class="n">fifo</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">)</span>
<span class="p">{</span>
<span class="p">}</span>

<span class="cp">#define TEST_BUF_COUNT 1</span>
<span class="cp">#define TEST_BUF_SIZE 74</span>

<span class="n">NET_BUF_POOL_DEFINE</span><span class="p">(</span><span class="n">bufs_pool</span><span class="p">,</span> <span class="n">TEST_BUF_COUNT</span><span class="p">,</span> <span class="n">TEST_BUF_SIZE</span><span class="p">,</span>
		    <span class="k">sizeof</span><span class="p">(</span><span class="kt">int</span><span class="p">),</span> <span class="nb">NULL</span><span class="p">);</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">test_get_single_buffer</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">struct</span> <span class="n">net_buf</span> <span class="o">*</span><span class="n">buf</span><span class="p">;</span>

	<span class="n">buf</span> <span class="o">=</span> <span class="n">net_buf_alloc</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bufs_pool</span><span class="p">,</span> <span class="n">K_NO_WAIT</span><span class="p">);</span>

	<span class="n">zassert_equal</span><span class="p">(</span><span class="n">buf</span><span class="o">-&gt;</span><span class="n">ref</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Invalid refcount&quot;</span><span class="p">);</span>
	<span class="n">zassert_equal</span><span class="p">(</span><span class="n">buf</span><span class="o">-&gt;</span><span class="n">len</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Invalid length&quot;</span><span class="p">);</span>
	<span class="n">zassert_equal</span><span class="p">(</span><span class="n">buf</span><span class="o">-&gt;</span><span class="n">flags</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s">&quot;Invalid flags&quot;</span><span class="p">);</span>
	<span class="n">zassert_equal_ptr</span><span class="p">(</span><span class="n">buf</span><span class="o">-&gt;</span><span class="n">frags</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">,</span> <span class="s">&quot;Frags not NULL&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ztest_test_suite</span><span class="p">(</span><span class="n">net_buf_test</span><span class="p">,</span>
		<span class="n">ztest_unit_test</span><span class="p">(</span><span class="n">test_get_single_buffer</span><span class="p">)</span>
	<span class="p">);</span>

	<span class="n">ztest_run_test_suite</span><span class="p">(</span><span class="n">net_buf_test</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="api-reference">
<h2>API reference<a class="headerlink" href="#api-reference" title="Permalink to this headline">¶</a></h2>
<div class="section" id="running-tests">
<h3>Running tests<a class="headerlink" href="#running-tests" title="Permalink to this headline">¶</a></h3>
<dl class="group">
<dt>
<span class="target" id="d0/d3b/group__ztest__test"></span><em>group</em> <code class="descname">ztest_test</code></dt>
<dd><p>This module eases the testing process by providing helpful macros and other testing structures. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="macro">
<dt id="c.ztest_unit_test_setup_teardown">
<span class="target" id="d0/d3b/group__ztest__test_1gafb04820b89dbc76bf28cb5e1c98764f8"></span><code class="descname">ztest_unit_test_setup_teardown</code><span class="sig-paren">(</span>fn, setup, teardown<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_unit_test_setup_teardown" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a test with setup and teardown functions. </p>
<p>This should be called as an argument to ztest_test_suite. The test will be run in the following order: <em>setup</em>, <em>fn</em>, <em>teardown</em>.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fn</span></code>: Main test function </li>
<li><code class="docutils literal"><span class="pre">setup</span></code>: Setup function </li>
<li><code class="docutils literal"><span class="pre">teardown</span></code>: Teardown function </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_user_unit_test_setup_teardown">
<span class="target" id="d0/d3b/group__ztest__test_1ga885301241dd259cb723603c8bbe29183"></span><code class="descname">ztest_user_unit_test_setup_teardown</code><span class="sig-paren">(</span>fn, setup, teardown<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_user_unit_test_setup_teardown" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a user mode test with setup and teardown functions. </p>
<p>This should be called as an argument to ztest_test_suite. The test will be run in the following order: <em>setup</em>, <em>fn</em>, <em>teardown</em>. ALL test functions will be run in user mode, and only if CONFIG_USERSPACE is enabled, otherwise this is the same as ztest_unit_test_setup_teardown().</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fn</span></code>: Main test function </li>
<li><code class="docutils literal"><span class="pre">setup</span></code>: Setup function </li>
<li><code class="docutils literal"><span class="pre">teardown</span></code>: Teardown function </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_unit_test">
<span class="target" id="d0/d3b/group__ztest__test_1gaf19dfe9baa08c481c11fd0470e30bc3f"></span><code class="descname">ztest_unit_test</code><span class="sig-paren">(</span>fn<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_unit_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a test function. </p>
<p>This should be called as an argument to ztest_test_suite.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fn</span></code>: Test function </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_user_unit_test">
<span class="target" id="d0/d3b/group__ztest__test_1ga6a7a2f0d98c31455701a282b8e1862cb"></span><code class="descname">ztest_user_unit_test</code><span class="sig-paren">(</span>fn<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_user_unit_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a test function that should run as a user thread. </p>
<p>This should be called as an argument to ztest_test_suite. If CONFIG_USERSPACE is not enabled, this is functionally identical to ztest_unit_test().</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">fn</span></code>: Test function </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_test_suite">
<span class="target" id="d0/d3b/group__ztest__test_1ga3108e97488ed30e428955cb0395005fe"></span><code class="descname">ztest_test_suite</code><span class="sig-paren">(</span>name, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_test_suite" title="Permalink to this definition">¶</a></dt>
<dd><p>Define a test suite. </p>
<p>This function should be called in the following fashion: <div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ztest_test_suite</span><span class="p">(</span><span class="n">test_suite_name</span><span class="p">,</span>
        <span class="n">ztest_unit_test</span><span class="p">(</span><span class="n">test_function</span><span class="p">),</span>
        <span class="n">ztest_unit_test</span><span class="p">(</span><span class="n">test_other_function</span><span class="p">)</span>
<span class="p">);</span>

<span class="n">ztest_run_test_suite</span><span class="p">(</span><span class="n">test_suite_name</span><span class="p">);</span>
</pre></div>
</div>
</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">name</span></code>: Name of the testing suite </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_run_test_suite">
<span class="target" id="d0/d3b/group__ztest__test_1ga7f76df4df4bf68a605b923fed8e5465c"></span><code class="descname">ztest_run_test_suite</code><span class="sig-paren">(</span>suite<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_run_test_suite" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the specified test suite. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">suite</span></code>: Test suite to run. </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Functions</p>
<dl class="function">
<dt id="_CPPv215ztest_test_failv">
<span id="ztest_test_fail__void"></span><span class="target" id="d0/d3b/group__ztest__test_1gacd6eb423f54dce8544f7c3b1618c0374"></span>void <code class="descname">ztest_test_fail</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215ztest_test_failv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Fail the currently running test. </p>
<p>This is the function called from failed assertions and the like. You probably don’t need to call it yourself. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv215ztest_test_passv">
<span id="ztest_test_pass__void"></span><span class="target" id="d0/d3b/group__ztest__test_1ga085d30a04102ebb8c3f2206020723ee0"></span>void <code class="descname">ztest_test_pass</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv215ztest_test_passv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Pass the currently running test. </p>
<p>Normally a test passes just by returning without an assertion failure. However, if the success case for your test involves a fatal fault, you can call this function from _SysFatalErrorHandler to indicate that the test passed before aborting the thread. </p>
</dd></dl>

<dl class="function">
<dt id="_CPPv214unit_test_noopv">
<span id="unit_test_noop__void"></span><span class="target" id="d0/d3b/group__ztest__test_1gaeb99bd1d29675ca8c31b519853cec422"></span><em class="property">static</em> void <code class="descname">unit_test_noop</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#_CPPv214unit_test_noopv" title="Permalink to this definition">¶</a><br /></dt>
<dd><p>Do nothing, successfully. </p>
<p>Unit test / setup function / teardown function that does nothing, successfully. Can be used as a parameter to ztest_unit_test_setup_teardown(). </p>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="assertions">
<h3>Assertions<a class="headerlink" href="#assertions" title="Permalink to this headline">¶</a></h3>
<p>These macros will instantly fail the test if the related assertion fails.
When an assertion fails, it will print the current file, line and function,
alongside a reason for the failure and an optional message. If the config
option:<cite>CONFIG_ZTEST_ASSERT_VERBOSE</cite> is 0, the assertions will only print the
file and line numbers, reducing the binary size of the test.</p>
<p>Example output for a failed macro from
<code class="docutils literal"><span class="pre">zassert_equal(buf-&gt;ref,</span> <span class="pre">2,</span> <span class="pre">&quot;Invalid</span> <span class="pre">refcount&quot;)</span></code>:</p>
<div class="highlight-none"><div class="highlight"><pre><span></span>Assertion failed at main.c:62: test_get_single_buffer: Invalid refcount (buf-&gt;ref not equal to 2)
Aborted at unit test function
</pre></div>
</div>
<dl class="group">
<dt>
<span class="target" id="d5/d99/group__ztest__assert"></span><em>group</em> <code class="descname">ztest_assert</code></dt>
<dd><p>This module provides assertions when using Ztest. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="macro">
<dt id="c.zassert">
<span class="target" id="d5/d99/group__ztest__assert_1ga4c36fe161245ebc643088c6a14f357f7"></span><code class="descname">zassert</code><span class="sig-paren">(</span>cond, default_msg, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert" title="Permalink to this definition">¶</a></dt>
<dd><p>Fail the test, if <em>cond</em> is false. </p>
<p>You probably don’t need to call this macro directly. You should instead use zassert_{condition} macros below.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">cond</span></code>: Condition to check </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional, can be NULL. Message to print if <em>cond</em> is false. </li>
<li><code class="docutils literal"><span class="pre">default_msg</span></code>: Message to print if <em>cond</em> is false </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_unreachable">
<span class="target" id="d5/d99/group__ztest__assert_1gaa61a2f8c8d530d5b149fc700993b6d03"></span><code class="descname">zassert_unreachable</code><span class="sig-paren">(</span>msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_unreachable" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that this function call won’t be reached. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_true">
<span class="target" id="d5/d99/group__ztest__assert_1ga2f30aa3d3bfe7281b86b725dec394466"></span><code class="descname">zassert_true</code><span class="sig-paren">(</span>cond, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_true" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that <em>cond</em> is true. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">cond</span></code>: Condition to check </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_false">
<span class="target" id="d5/d99/group__ztest__assert_1gacc41f998b701997e4eafb6ed7b9d537c"></span><code class="descname">zassert_false</code><span class="sig-paren">(</span>cond, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_false" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that <em>cond</em> is false. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">cond</span></code>: Condition to check </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_is_null">
<span class="target" id="d5/d99/group__ztest__assert_1ga0380ea00fa3775f9a8a05faaf4de71b7"></span><code class="descname">zassert_is_null</code><span class="sig-paren">(</span>ptr, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_is_null" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that <em>ptr</em> is NULL. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">ptr</span></code>: Pointer to compare </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_not_null">
<span class="target" id="d5/d99/group__ztest__assert_1gad78332e6bd37812e56ccc4af601542e4"></span><code class="descname">zassert_not_null</code><span class="sig-paren">(</span>ptr, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_not_null" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that <em>ptr</em> is not NULL. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">ptr</span></code>: Pointer to compare </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_equal">
<span class="target" id="d5/d99/group__ztest__assert_1ga107b470a617e5c398353db398a3424e2"></span><code class="descname">zassert_equal</code><span class="sig-paren">(</span>a, b, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that <em>a</em> equals <em>b</em>. </p>
<p><em>a</em> and <em>b</em> won’t be converted and will be compared directly.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">a</span></code>: Value to compare </li>
<li><code class="docutils literal"><span class="pre">b</span></code>: Value to compare </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_not_equal">
<span class="target" id="d5/d99/group__ztest__assert_1ga9591c44c125ca0a073c0d80dc0d84a3b"></span><code class="descname">zassert_not_equal</code><span class="sig-paren">(</span>a, b, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_not_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that <em>a</em> does not equal <em>b</em>. </p>
<p><em>a</em> and <em>b</em> won’t be converted and will be compared directly.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">a</span></code>: Value to compare </li>
<li><code class="docutils literal"><span class="pre">b</span></code>: Value to compare </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.zassert_equal_ptr">
<span class="target" id="d5/d99/group__ztest__assert_1ga8787deba6ec667b7b14e12b5eb3e0d53"></span><code class="descname">zassert_equal_ptr</code><span class="sig-paren">(</span>a, b, msg, ...<span class="sig-paren">)</span><a class="headerlink" href="#c.zassert_equal_ptr" title="Permalink to this definition">¶</a></dt>
<dd><p>Assert that <em>a</em> equals <em>b</em>. </p>
<p><em>a</em> and <em>b</em> will be converted to <code class="docutils literal"><span class="pre">void</span> <span class="pre">*</span></code> before comparing.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">a</span></code>: Value to compare </li>
<li><code class="docutils literal"><span class="pre">b</span></code>: Value to compare </li>
<li><code class="docutils literal"><span class="pre">msg</span></code>: Optional message to print if the assertion fails </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

</div>
<div class="section" id="mocking">
<h3>Mocking<a class="headerlink" href="#mocking" title="Permalink to this headline">¶</a></h3>
<p>These functions allow abstracting callbacks and related functions and
controlling them from specific tests. You can enable the mocking framework by
setting <a class="reference internal" href="../../reference/kconfig/CONFIG_ZTEST_MOCKING.html#cmdoption-arg-config-ztest-mocking"><code class="xref std std-option docutils literal"><span class="pre">CONFIG_ZTEST_MOCKING</span></code></a> to “y” in the configuration file of the
test.  The amount of concurrent return values and expected parameters is
limited by <a class="reference internal" href="../../reference/kconfig/CONFIG_ZTEST_PARAMETER_COUNT.html#cmdoption-arg-config-ztest-parameter-count"><code class="xref std std-option docutils literal"><span class="pre">CONFIG_ZTEST_PARAMETER_COUNT</span></code></a>.</p>
<p>Here is an example for configuring the function <code class="docutils literal"><span class="pre">expect_two_parameters</span></code> to
expect the values <code class="docutils literal"><span class="pre">a=2</span></code> and <code class="docutils literal"><span class="pre">b=3</span></code>, and telling <code class="docutils literal"><span class="pre">returns_int</span></code> to return
<code class="docutils literal"><span class="pre">5</span></code>:</p>
<div class="highlight-c"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;ztest.h&gt;</span><span class="cp"></span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">expect_two_parameters</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">b</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ztest_check_expected_value</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
	<span class="n">ztest_check_expected_value</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">parameter_tests</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ztest_expect_value</span><span class="p">(</span><span class="n">expect_two_parameters</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
	<span class="n">ztest_expect_value</span><span class="p">(</span><span class="n">expect_two_parameters</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
	<span class="n">expect_two_parameters</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">int</span> <span class="nf">returns_int</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="k">return</span> <span class="n">ztest_get_return_value</span><span class="p">();</span>
<span class="p">}</span>

<span class="k">static</span> <span class="kt">void</span> <span class="nf">return_value_tests</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ztest_returns_value</span><span class="p">(</span><span class="n">returns_int</span><span class="p">,</span> <span class="mi">5</span><span class="p">);</span>
	<span class="n">zassert_equal</span><span class="p">(</span><span class="n">returns_int</span><span class="p">(),</span> <span class="mi">5</span><span class="p">,</span> <span class="nb">NULL</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">test_main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span>
<span class="p">{</span>
	<span class="n">ztest_test_suite</span><span class="p">(</span><span class="n">mock_framework_tests</span><span class="p">,</span>
		<span class="n">ztest_unit_test</span><span class="p">(</span><span class="n">parameter_test</span><span class="p">),</span>
		<span class="n">ztest_unit_test</span><span class="p">(</span><span class="n">return_value_test</span><span class="p">)</span>
	<span class="p">);</span>

	<span class="n">ztest_run_test_suite</span><span class="p">(</span><span class="n">mock_framework_tests</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<dl class="group">
<dt>
<span class="target" id="d9/dba/group__ztest__mock"></span><em>group</em> <code class="descname">ztest_mock</code></dt>
<dd><p>This module provides simple mocking functions for unit testing. These need CONFIG_ZTEST_MOCKING=y. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric">Defines</p>
<dl class="macro">
<dt id="c.ztest_expect_value">
<span class="target" id="d9/dba/group__ztest__mock_1ga58c2f0c0e628e73a2268a3d18b0440d6"></span><code class="descname">ztest_expect_value</code><span class="sig-paren">(</span>func, param, value<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_expect_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell function <em>func</em> to expect the value <em>value</em> for <em>param</em>. </p>
<p>When using ztest_check_expected_value(), tell that the value of <em>param</em> should be <em>value</em>. The value will internally be stored as an <code class="docutils literal"><span class="pre">uintptr_t</span></code>.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">func</span></code>: Function in question </li>
<li><code class="docutils literal"><span class="pre">param</span></code>: Parameter for which the value should be set </li>
<li><code class="docutils literal"><span class="pre">value</span></code>: Value for <em>param</em> </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_check_expected_value">
<span class="target" id="d9/dba/group__ztest__mock_1gae9af6ba8e51738e938763c896f17ea8f"></span><code class="descname">ztest_check_expected_value</code><span class="sig-paren">(</span>param<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_check_expected_value" title="Permalink to this definition">¶</a></dt>
<dd><p>If <em>param</em> doesn’t match the value set by ztest_expect_value(), fail the test. </p>
<p>This will first check that does <em>param</em> have a value to be expected, and then checks whether the value of the parameter is equal to the expected value. If either of these checks fail, the current test will fail. This must be called from the called function.</p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">param</span></code>: Parameter to check </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_returns_value">
<span class="target" id="d9/dba/group__ztest__mock_1ga2ec539b4c0f3e4efb695213b4fd08c2c"></span><code class="descname">ztest_returns_value</code><span class="sig-paren">(</span>func, value<span class="sig-paren">)</span><a class="headerlink" href="#c.ztest_returns_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell <em>func</em> that it should return <em>value</em>. </p>
<p><dl class="docutils">
<dt><strong>Parameters</strong></dt>
<dd><ul class="breatheparameterlist first last simple">
<li><code class="docutils literal"><span class="pre">func</span></code>: Function that should return <em>value</em> </li>
<li><code class="docutils literal"><span class="pre">value</span></code>: Value to return from <em>func</em> </li>
</ul>
</dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_get_return_value">
<span class="target" id="d9/dba/group__ztest__mock_1ga31dcd5b5a3596a7404a771a2d32f3a39"></span><code class="descname">ztest_get_return_value</code><a class="headerlink" href="#c.ztest_get_return_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the return value for current function. </p>
<p>The return value must have been set previously with ztest_returns_value(). If no return value exists, the current test will fail.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>The value the current function should return </dd>
</dl>
</p>
</dd></dl>

<dl class="macro">
<dt id="c.ztest_get_return_value_ptr">
<span class="target" id="d9/dba/group__ztest__mock_1gaa2df2eaeba49019b7a83ac769ea95968"></span><code class="descname">ztest_get_return_value_ptr</code><a class="headerlink" href="#c.ztest_get_return_value_ptr" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the return value as a pointer for current function. </p>
<p>The return value must have been set previously with ztest_returns_value(). If no return value exists, the current test will fail.</p>
<p><dl class="docutils">
<dt><strong>Return</strong></dt>
<dd>The value the current function should return as a <code class="docutils literal"><span class="pre">void</span> <span class="pre">*</span></code> </dd>
</dl>
</p>
</dd></dl>

</div>
</dd></dl>

</div>
</div>
</div>


                </div>
              </div>
              <!-- 
  <div class="rst-footer-buttons row" role="navigation" aria-label="footer navigation">
    
      <a href="sanitycheck.html" class="btn btn-neutral float-right" title="Zephyr Sanity Tests" accesskey="n">
        Next <span class="fa fa-arrow-circle-right"></span>
      </a>
    
    
      <a href="index.html" class="btn btn-neutral" title="Testing" accesskey="p">
        <span class="fa fa-arrow-circle-left"></span> Previous
      </a>
    
  </div>
  for ZEP-463 remove the prev/next links -->
            </div>
            <!-- ENDS #content SECTION -->
          </section>
          <!-- ENDS .content -->
        </div>
        <!-- ENDS .main-container -->
      </div>
      <!-- ENDS #main -->
      <footer id="footer">
  <div class="container">
    <div class="block block-menu block-odd first block" data-bid="menu-footer-menu">
      <h3 class="title">Footer Menu</h3>
      <ul class="menu">
        <li class="leaf google- mid-2404">
          <a href="https://plus.google.com/+ZephyrProject" class="google-plus"><span>Google+</span></a>
        </li>
        <li class="leaf twitter mid-2405">
          <a href="https://twitter.com/zephyriot" class="twitter"><span>Twitter</span></a>
        </li>
        <li class="last leaf email mid-2406">
          <a href="mailto:info@zephyrproject.org" class="email"><span>Email</span></a>
        </li>
      </ul>
    </div>
    <div class="block block-block block-even block" data-bid="block-4">
      <p>
        Zephyr Project © 2018 is a Linux Foundation Project. All Rights Reserved.
      </p>
      <p>
        <a href="https://linuxfoundation.org" target="_blank">Linux Foundation</a> is a registered trademark of The Linux Foundation. Linux is a registered <a href="https://www.linuxfoundation.org/about/linux-foundation-trademark-usage-guidelines" target="_blank">trademark</a> of Linus Torvalds.
      </p>
      <p>
        Please see our <a href="https://www.linuxfoundation.org/privacy" target="_blank">privacy policy</a> and <a href="https://www.linuxfoundation.org/terms" target="_blank">terms of use</a>
      </p>
    </div>
  </div>
</footer>
    </div>
    <!-- ENDS #page -->

  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.10.99',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>
      <script type="text/javascript" src="../../_static/js/main.js"></script>
      <script type="text/javascript" src="../../_static/js/app.js"></script>
      <script type="text/javascript" src="../../_static/js/affix.js"></script>

   

  </body>
</html>